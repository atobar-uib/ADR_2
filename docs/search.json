[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Estad√≠stica Aplicada con R",
    "section": "",
    "text": "Prefacio\nHa sido elaborado con Quarto",
    "crumbs": [
      "Prefacio"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Introducci√≥n",
    "section": "",
    "text": "En este curso se estudiar√°n: blablabla",
    "crumbs": [
      "Introducci√≥n"
    ]
  },
  {
    "objectID": "Contrastes_de_hipotesis.html",
    "href": "Contrastes_de_hipotesis.html",
    "title": "2¬† Constrastes de hip√≥tesis",
    "section": "",
    "text": "2.1 Contrastes param√©tricos y no param√©tricos",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Constrastes de hip√≥tesis</span>"
    ]
  },
  {
    "objectID": "Contrastes_de_hipotesis.html#tests-de-medias",
    "href": "Contrastes_de_hipotesis.html#tests-de-medias",
    "title": "2¬† Constrastes de hip√≥tesis",
    "section": "2.2 Tests de medias",
    "text": "2.2 Tests de medias",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Constrastes de hip√≥tesis</span>"
    ]
  },
  {
    "objectID": "Contrastes_de_hipotesis.html#tests-de-varianzas",
    "href": "Contrastes_de_hipotesis.html#tests-de-varianzas",
    "title": "2¬† Constrastes de hip√≥tesis",
    "section": "2.3 Tests de varianzas",
    "text": "2.3 Tests de varianzas",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Constrastes de hip√≥tesis</span>"
    ]
  },
  {
    "objectID": "Contrastes_de_hipotesis.html#tests-de-proporciones",
    "href": "Contrastes_de_hipotesis.html#tests-de-proporciones",
    "title": "2¬† Constrastes de hip√≥tesis",
    "section": "2.4 Tests de proporciones",
    "text": "2.4 Tests de proporciones",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Constrastes de hip√≥tesis</span>"
    ]
  },
  {
    "objectID": "Contrastes_de_hipotesis.html#otros-tests",
    "href": "Contrastes_de_hipotesis.html#otros-tests",
    "title": "2¬† Constrastes de hip√≥tesis",
    "section": "2.5 Otros tests?",
    "text": "2.5 Otros tests?",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Constrastes de hip√≥tesis</span>"
    ]
  },
  {
    "objectID": "Regresion.html",
    "href": "Regresion.html",
    "title": "4¬† Regresi√≥n simple",
    "section": "",
    "text": "5 Regresi√≥n m√∫ltiple",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Regresi√≥n simple</span>"
    ]
  },
  {
    "objectID": "Supervivencia.html",
    "href": "Supervivencia.html",
    "title": "5¬† An√°lisis de supervivencia",
    "section": "",
    "text": "5.1 Estimador de Kaplan-Meier (K-M)",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>An√°lisis de supervivencia</span>"
    ]
  },
  {
    "objectID": "Supervivencia.html#modelos-de-regresi√≥n-de-cox",
    "href": "Supervivencia.html#modelos-de-regresi√≥n-de-cox",
    "title": "5¬† An√°lisis de supervivencia",
    "section": "5.2 Modelos de regresi√≥n de Cox",
    "text": "5.2 Modelos de regresi√≥n de Cox",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>An√°lisis de supervivencia</span>"
    ]
  },
  {
    "objectID": "Modelos_lineales.html",
    "href": "Modelos_lineales.html",
    "title": "6¬† Modelos lineales generalizados (GLM)",
    "section": "",
    "text": "6.1 üìñ Cap√≠tulo 1: Introducci√≥n a los Modelos Lineales Generalizados",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Modelos lineales generalizados (GLM)</span>"
    ]
  },
  {
    "objectID": "Modelos_lineales.html#cap√≠tulo-1-introducci√≥n-a-los-modelos-lineales-generalizados",
    "href": "Modelos_lineales.html#cap√≠tulo-1-introducci√≥n-a-los-modelos-lineales-generalizados",
    "title": "6¬† Modelos lineales generalizados (GLM)",
    "section": "",
    "text": "Objetivos del cap√≠tulo:\n\nEntender las limitaciones de la regresi√≥n lineal cl√°sica\nConocer qu√© son los Modelos Lineales Generalizados (GLM)\nAprender por qu√© son esenciales en an√°lisis m√©dicos y sanitarios\nFamiliarizarse con la estructura b√°sica de un GLM\n\n\n\n¬øQu√© son los Modelos Lineales Generalizados?\nLos Modelos Lineales Generalizados (GLM, por sus siglas en ingl√©s) son una extensi√≥n de los modelos lineales tradicionales que permiten modelar variables respuesta que no se distribuyen normalmente.\nFueron introducidos por Nelder y Wedderburn en 1972 como una forma flexible de abordar muchos tipos de datos comunes en investigaci√≥n, especialmente cuando:\n\nLa variable dependiente es binaria (s√≠/no, √©xito/fracaso)\nEs un conteo (n√∫mero de hospitalizaciones, eventos adversos)\nEs positiva y continua, pero no normal (gastos sanitarios, tiempo de recuperaci√≥n)",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Modelos lineales generalizados (GLM)</span>"
    ]
  },
  {
    "objectID": "Modelos_lineales.html#limitaciones-de-la-regresi√≥n-lineal-en-medicina",
    "href": "Modelos_lineales.html#limitaciones-de-la-regresi√≥n-lineal-en-medicina",
    "title": "6¬† Modelos lineales generalizados (GLM)",
    "section": "Limitaciones de la regresi√≥n lineal en medicina",
    "text": "Limitaciones de la regresi√≥n lineal en medicina\nLa regresi√≥n lineal cl√°sica asume lo siguiente:\n\nLa variable respuesta sigue una distribuci√≥n normal\nLa relaci√≥n entre las variables independientes y la dependiente es lineal\nLos residuos tienen varianza constante (homocedasticidad)\n\nSin embargo, estas condiciones rara vez se cumplen en muchos estudios m√©dicos. Por ejemplo:\n\nEjemplo 1: Variable binaria ‚Äì √âxito o fracaso quir√∫rgico\nImagina que est√°s analizando si un paciente tiene complicaciones tras una cirug√≠a (s√≠ = 1, no = 0). Si usas un modelo lineal:\n\nPodr√≠as predecir valores fuera del rango [0,1], lo cual no tiene sentido\nEl error tendr√≠a varianza distinta seg√∫n el valor predicho ‚Üí viola el supuesto de homocedasticidad\n\n\n\nEjemplo 2: Conteos ‚Äì N√∫mero de reingresos hospitalarios\nSi est√°s contando cu√°ntas veces un paciente ha sido ingresado en el √∫ltimo a√±o:\n\nEstos datos suelen tener muchos ceros y pocos valores altos ‚Üí cola derecha pesada\nNo pueden ser negativos ‚Üí la normalidad no es adecuada\nUsar una regresi√≥n lineal podr√≠a dar predicciones negativas\n\n\n\nEjemplo 3: Tiempo de recuperaci√≥n ‚Äì Variable positiva y sesgada\nEn lugar de usar una regresi√≥n lineal, que asume simetr√≠a, ser√≠a m√°s apropiado usar una distribuci√≥n como Gamma o log-normal\n\n\n¬øPor qu√© usar GLM en medicina?\nLos GLM son una herramienta fundamental en investigaci√≥n m√©dica porque:\n\n\n‚úÖ Permiten trabajar con distintos tipos de variables\n\nBinarias (log√≠stica)\nDe conteo (Poisson, binomial negativa)\nPositivas continuas (Gamma)\n\n\n\n‚úÖ Ofrecen interpretaciones cl√≠nicas √∫tiles\n\nEn log√≠stica: odds ratios\nEn Poisson: tasas relativas\nEn Gamma: relaciones multiplicativas en tiempos o costes\n\n\n\n‚úÖ Mejoran la precisi√≥n al respetar la naturaleza de los datos\nNo forzan una distribuci√≥n normal donde no existe, mejorando la validez estad√≠stica de los resultados\n\n\n‚úÖ Son f√°ciles de implementar en R\nCon funciones b√°sicas como glm() y paquetes adicionales como broom, effects o visreg, podemos construir, visualizar e interpretar modelos r√°pidamente\n\n\nCaso pr√°ctico introductorio: Predicci√≥n de bajo peso al nacer\nPara ilustrar c√≥mo pueden aplicarse los GLM en medicina, vamos a usar el conjunto de datos birthwt del paquete MASS. Este dataset contiene informaci√≥n sobre 189 embarazos y si el beb√© naci√≥ con bajo peso (&lt; 2500 gramos).\n\nlibrary(MASS)\ndata(birthwt)\nstr(birthwt)\n\n'data.frame':   189 obs. of  10 variables:\n $ low  : int  0 0 0 0 0 0 0 0 0 0 ...\n $ age  : int  19 33 20 21 18 21 22 17 29 26 ...\n $ lwt  : int  182 155 105 108 107 124 118 103 123 113 ...\n $ race : int  2 3 1 1 1 3 1 3 1 1 ...\n $ smoke: int  0 0 1 1 1 0 0 0 1 1 ...\n $ ptl  : int  0 0 0 0 0 0 0 0 0 0 ...\n $ ht   : int  0 0 0 0 0 0 0 0 0 0 ...\n $ ui   : int  1 0 0 1 1 0 0 0 0 0 ...\n $ ftv  : int  0 3 1 2 0 0 1 1 1 0 ...\n $ bwt  : int  2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...\n\n\nAlgunas variables relevantes: - low: 1 si el beb√© naci√≥ con bajo peso, 0 en caso contrario - age: edad de la madre - lwt: peso en la √∫ltima menstruaci√≥n - smoke: si la madre fumaba durante el embarazo - ptl: n√∫mero de partos prematuros previos - ht: hipertensi√≥n arterial - ui: irritabilidad uterina\nEste tipo de problema requiere un modelo log√≠stico, ya que la variable dependiente es binaria. Veremos c√≥mo construirlo y c√≥mo interpretarlo en el pr√≥ximo cap√≠tulo.\n\n\nHerramientas en R para GLM\nTrabajaremos principalmente con estos paquetes:\n\n\n\nPaquete\nFuncionalidad\n\n\n\n\nstats\nglm() - Modelo base\n\n\nMASS\nglm.nb() - Regresi√≥n binomial negativa\n\n\nbroom\nRes√∫menes limpios de modelos\n\n\nvisreg\nVisualizaci√≥n de efectos\n\n\npROC\nCurvas ROC y AUC\n\n\nDHARMa\nDiagn√≥stico de residuos\n\n\n\nInst√°lalos ahora si no los tienes:\n\ninstall.packages(c(\"MASS\", \"broom\", \"visreg\", \"pROC\", \"DHARMa\"))",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Modelos lineales generalizados (GLM)</span>"
    ]
  },
  {
    "objectID": "Modelos_lineales.html#cap√≠tulo-2-conceptos-b√°sicos-de-los-modelos-lineales-generalizados-glm",
    "href": "Modelos_lineales.html#cap√≠tulo-2-conceptos-b√°sicos-de-los-modelos-lineales-generalizados-glm",
    "title": "6¬† Modelos lineales generalizados (GLM)",
    "section": "6.2 üìò Cap√≠tulo 2: Conceptos b√°sicos de los Modelos Lineales Generalizados (GLM)",
    "text": "6.2 üìò Cap√≠tulo 2: Conceptos b√°sicos de los Modelos Lineales Generalizados (GLM)\n\n6.2.1 Objetivos del cap√≠tulo:\n\nComprender qu√© es un modelo lineal generalizado\nDistinguir entre regresi√≥n lineal y GLM\nConocer los tres componentes principales de un GLM\nEntender las funciones de distribuci√≥n y enlace m√°s usadas\nSaber c√≥mo elegir el modelo adecuado seg√∫n el tipo de variable\n\n\n\n6.2.2 ¬øQu√© es un Modelo Lineal Generalizado?\nUn Modelo Lineal Generalizado (GLM) es una extensi√≥n de los modelos lineales cl√°sicos que permite modelar variables respuesta que no siguen una distribuci√≥n normal.\nA diferencia de la regresi√≥n lineal tradicional, los GLM permiten:\n\nModelar variables dependientes no normales: binarias, conteos, positivas continuas‚Ä¶\nUsar una funci√≥n de enlace para relacionar la media de la variable respuesta con una combinaci√≥n lineal de predictores\nTrabajar sin asumir homocedasticidad ni normalidad de errores\n\nEn resumen, son ideales para muchas situaciones comunes en investigaci√≥n m√©dica.\n\n\n6.2.3 Los tres componentes de un GLM\nUn GLM se define por tres elementos fundamentales:\n\n\n1. Funci√≥n de distribuci√≥n\nEs la distribuci√≥n estad√≠stica de la variable respuesta. Algunas distribuciones comunes son:\n\n\n\nDistribuci√≥n\nTipo de variable\n\n\n\n\nBinomial\nVariable binaria (s√≠/no)\n\n\nPoisson\nConteos\n\n\nGamma\nVariables positivas continuas\n\n\nGama inversa\nTiempos hasta un evento\n\n\nBinomial negativa\nConteos con sobredispersi√≥n\n\n\n\n\n\n2. Funci√≥n de enlace\nEs la relaci√≥n matem√°tica entre la media de la variable respuesta (\\(\\mu\\)) y la combinaci√≥n lineal de predictores (\\(\\eta\\)).\n\\[ g(\\mu) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_p x_p \\]\nAlgunas funciones de enlace comunes:\n\n\n\nDistribuci√≥n\nFunci√≥n de enlace t√≠pica\n\n\n\n\nBinomial\nLogit\n\n\nPoisson\nLog\n\n\nGamma\nInversa\n\n\nNormal\nIdentidad\n\n\n\nüí° Ejemplo: En la regresi√≥n log√≠stica, la funci√≥n de enlace es el logit, que transforma probabilidades en valores reales.\n\n\n3. Componente sistem√°tico\nEs la parte lineal del modelo, formada por la combinaci√≥n de las variables independientes.\n\\[ \\eta = X \\beta \\]\nDonde \\(X\\) es la matriz de dise√±o (variables independientes) y \\(\\beta\\) son los coeficientes estimados.\n\n\nTipos de GLM seg√∫n la variable dependiente\nDependiendo del tipo de variable que queramos modelar, utilizaremos distintas combinaciones de distribuci√≥n y funci√≥n de enlace:\n\n\n6.2.4 üîπ Regresi√≥n log√≠stica (variable binaria)\n\nDistribuci√≥n: Binomial\nFunci√≥n de enlace: Logit\nEjemplo m√©dico: predecir si un paciente desarrollar√° diabetes (s√≠/no)\n\n\nset.seed(123)  # Para reproducibilidad\n\nn &lt;- 500\ndatos_medicos &lt;- data.frame(\n  edad = round(rnorm(n, mean = 55, sd = 10)),\n  imc = round(rnorm(n, mean = 28, sd = 4), 1),\n  presion = round(rnorm(n, mean = 130, sd = 15)),\n  colesterol = round(rnorm(n, mean = 200, sd = 40)),\n  fumador = rbinom(n, 1, 0.3),\n  familia_diab = rbinom(n, 1, 0.25)\n)\n\n# Calculamos el logaritmo de las odds\nlog_odds &lt;- with(datos_medicos,\n                 -6 + 0.05 * edad + 0.1 * imc + 0.02 * presion +\n                 0.01 * colesterol + 0.8 * fumador + 1.2 * familia_diab)\n\n# Convertimos a probabilidades con la funci√≥n log√≠stica\nprob_diabetes &lt;- plogis(log_odds)\n\nprob_diabetes &lt;- (prob_diabetes - min(prob_diabetes)) / (max(prob_diabetes) - min(prob_diabetes))\n\n# Generamos la variable binaria final\ndatos_medicos$diabetes &lt;- rbinom(n, 1, prob_diabetes)\n\nmodelo_logistico &lt;- glm(diabetes ~ edad + imc + fumador,\n                        data = datos_medicos, family = binomial(link = \"logit\"))\n\n\n\nüîπ Regresi√≥n de Poisson (conteos)\n\nDistribuci√≥n: Poisson\nFunci√≥n de enlace: Log\nEjemplo m√©dico: n√∫mero de hospitalizaciones en un a√±o\n\n\nset.seed(456)  # Para reproducibilidad\n\nn &lt;- 300\ndatos_hosp &lt;- data.frame(\n  edad = round(rnorm(n, mean = 65, sd = 10)),\n  enfermedad = sample(c(\"HTA\", \"Diabetes\", \"EPOC\"), n, replace = TRUE),\n  bmi = round(rnorm(n, mean = 28, sd = 4), 1),\n  fumador = rbinom(n, 1, 0.3),\n  tiempo_enfermedad = round(runif(n, min = 1, max = 15), 1)\n)\n# Calculamos el lambda (tasa media de hospitalizaci√≥n) usando un modelo log-lineal\nlambda &lt;- exp(-2 + 0.03 * datos_hosp$edad +\n              ifelse(datos_hosp$enfermedad == \"Diabetes\", 0.4,\n                     ifelse(datos_hosp$enfermedad == \"EPOC\", 0.7, 0)) +\n              0.02 * datos_hosp$bmi +\n              0.5 * datos_hosp$fumador +\n              0.05 * datos_hosp$tiempo_enfermedad)\n\n# Generamos el n√∫mero de hospitalizaciones usando una distribuci√≥n Poisson\ndatos_hosp$hospitalizaciones &lt;- rpois(n, lambda = lambda)\n\n\nmodelo_poisson &lt;- glm(hospitalizaciones ~ edad + enfermedad,\n                      data = datos_hosp, family = poisson())\n\n\n\nüîπ Regresi√≥n Gamma (variables positivas continuas)\n\nDistribuci√≥n: Gamma\nFunci√≥n de enlace: Inversa o log\nEjemplo m√©dico: tiempo de recuperaci√≥n tras cirug√≠a\n\n\nset.seed(789)  # Para reproducibilidad\n\nn &lt;- 400\ndatos_cirugia &lt;- data.frame(\n  edad = round(rnorm(n, mean = 60, sd = 12)),\n  tratamiento = sample(c(\"A\", \"B\", \"C\"), n, replace = TRUE),\n  complicaciones = rbinom(n, 1, 0.25),\n  duracion_cirugia = round(runif(n, min = 30, max = 180)),\n  imc = round(rnorm(n, mean = 27, sd = 4), 1)\n)\n\n# Simulamos el tiempo de recuperaci√≥n usando un modelo log-lineal\nlog_tiempo_medio &lt;- 3 + 0.01 * datos_cirugia$edad +\n  ifelse(datos_cirugia$tratamiento == \"B\", 0.2,\n         ifelse(datos_cirugia$tratamiento == \"C\", 0.4, 0)) +\n  0.5 * datos_cirugia$complicaciones +\n  0.005 * datos_cirugia$duracion_cirugia +\n  0.02 * datos_cirugia$imc\n\n# Generamos tiempos de recuperaci√≥n con una distribuci√≥n log-normal\ndatos_cirugia$tiempo_recuperacion &lt;- round(rlnorm(n, meanlog = log_tiempo_medio, sdlog = 0.3), 1)\n\n\nmodelo_gamma &lt;- glm(tiempo_recuperacion ~ edad + tratamiento,\n                    data = datos_cirugia, family = Gamma(link = \"inverse\"))\n\n\n\nüîπ Regresi√≥n lineal (caso especial de GLM)\n\nDistribuci√≥n: Normal\nFunci√≥n de enlace: Identidad\nEjemplo m√©dico: nivel de colesterol en sangre\n\n\nset.seed(987)  # Para reproducibilidad\n\nn &lt;- 600\ndatos_cardio &lt;- data.frame(\n  edad = round(rnorm(n, mean = 50, sd = 10)),\n  sexo = sample(c(\"Hombre\", \"Mujer\"), n, replace = TRUE),\n  peso = round(rnorm(n, mean = 70, sd = 12), 1),\n  altura = round(runif(n, min = 1.50, max = 1.90), 2)\n)\n\n# Calculamos el IMC\ndatos_cardio$imc &lt;- datos_cardio$peso / (datos_cardio$altura)^2\n\n# Variables adicionales\ndatos_cardio$dieta &lt;- rbinom(n, 1, prob = ifelse(datos_cardio$sexo == \"Mujer\", 0.4, 0.3))\ndatos_cardio$ejercicio &lt;- round(runif(n, min = 0, max = 10), 1)\n\n# Simulamos el nivel de colesterol usando un modelo lineal\ncolesterol_base &lt;- 200 + 0.3 * datos_cardio$edad +\n  ifelse(datos_cardio$sexo == \"Hombre\", 10, 0) +\n  1.2 * datos_cardio$imc +\n  -5 * datos_cardio$dieta +\n  -0.4 * datos_cardio$ejercicio\n\n# A√±adimos variabilidad aleatoria\ndatos_cardio$colesterol &lt;- round(colesterol_base + rnorm(n, sd = 15), 0)\nmodelo_normal &lt;- glm(colesterol ~ dieta + ejercicio,\n                     data = datos_cardio, family = gaussian())\n\n\n\n6.2.5 Elecci√≥n del modelo correcto\nPara elegir el GLM adecuado, debes considerar:\n\n¬øQu√© tipo de variable es la respuesta?\n\nBinaria ‚Üí log√≠stica\nConteo ‚Üí Poisson o binomial negativa\nPositiva continua ‚Üí Gamma\nProporciones ‚Üí Beta (fuera de GLM b√°sico, pero hay extensiones)\n\n¬øHay sobredispersi√≥n?\n\nSi la varianza es mayor que la media en conteos ‚Üí usa binomial negativa\n\n¬øNecesito interpretar resultados cl√≠nicos?\n\nOdds ratios, tasas relativas‚Ä¶ todo esto lo obtienes f√°cilmente al exponentiar los coeficientes\n\n\n\n\nEjemplo pr√°ctico: elecci√≥n del modelo en medicina\nImagina que trabajas con un dataset sobre pacientes operados y quieres estudiar cu√°nto tardan en recuperarse.\nTienes estas variables:\n\ntiempo_recuperacion: d√≠as desde la operaci√≥n hasta alta hospitalaria\nedad: a√±os\ntratamiento: tipo de intervenci√≥n (A, B, C)\ncomplicaciones: s√≠/no\n\nPodr√≠amos usar un GLM Gamma con enlace logar√≠tmico:\n\nset.seed(1234)  # Para reproducibilidad\n\nn &lt;- 350\ndatos_operados &lt;- data.frame(\n  edad = round(rnorm(n, mean = 60, sd = 10)),\n  tratamiento = sample(c(\"A\", \"B\", \"C\"), n, replace = TRUE),\n  complicaciones = rbinom(n, 1, 0.2),\n  duracion_cirugia = round(runif(n, min = 30, max = 180)),\n  imc = round(rnorm(n, mean = 27, sd = 4), 1)\n)\n\n# Simulamos el tiempo de recuperaci√≥n usando un modelo log-lineal\nlog_tiempo_medio &lt;- 3 + 0.01 * datos_operados$edad +\n  ifelse(datos_operados$tratamiento == \"B\", 0.2,\n         ifelse(datos_operados$tratamiento == \"C\", 0.4, 0)) +\n  0.5 * datos_operados$complicaciones +\n  0.005 * datos_operados$duracion_cirugia +\n  0.02 * datos_operados$imc\n\n# Generamos tiempos de recuperaci√≥n con una distribuci√≥n log-normal\ndatos_operados$tiempo_recuperacion &lt;- round(rlnorm(n, meanlog = log_tiempo_medio, sdlog = 0.3), 1)\n\nmodelo_recuperacion &lt;- glm(tiempo_recuperacion ~ edad + tratamiento + complicaciones,\n                           data = datos_operados, family = Gamma(link = \"log\"))\nsummary(modelo_recuperacion)\n\n\nCall:\nglm(formula = tiempo_recuperacion ~ edad + tratamiento + complicaciones, \n    family = Gamma(link = \"log\"), data = datos_operados)\n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    4.248493   0.132173  32.143  &lt; 2e-16 ***\nedad           0.007516   0.002077   3.619  0.00034 ***\ntratamientoB   0.228853   0.051474   4.446 1.18e-05 ***\ntratamientoC   0.416758   0.048329   8.623 2.40e-16 ***\ncomplicaciones 0.516802   0.050872  10.159  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Gamma family taken to be 0.1445412)\n\n    Null deviance: 75.286  on 349  degrees of freedom\nResidual deviance: 47.806  on 345  degrees of freedom\nAIC: 3784.7\n\nNumber of Fisher Scoring iterations: 5\n\n\nEste modelo respeta la naturaleza positiva y sesgada del tiempo de recuperaci√≥n, y nos permite interpretar los efectos como factores multiplicativos del tiempo medio de recuperaci√≥n.\n\n\n6.2.6 Interpretaci√≥n de los coeficientes\nLos coeficientes de un GLM se interpretan en escala del predictor lineal, pero al aplicar la funci√≥n de enlace inversa, podemos obtener predicciones en la escala original de la variable respuesta.\nPor ejemplo, en un modelo log√≠stico:\n\nexp(coef(modelo_logistico)[\"fumador\"])\n\n fumador \n3.128824 \n\n\nNos dar√≠a el odds ratio asociado al h√°bito tab√°quico, algo muy com√∫n en estudios m√©dicos.\n\n\n6.2.7 Diagn√≥stico b√°sico de modelos\nAunque veremos diagn√≥sticos m√°s avanzados en cap√≠tulos posteriores, aqu√≠ tienes algunas herramientas √∫tiles:\n\n# Resumen del modelo\nsummary(modelo_recuperacion)\n\n\nCall:\nglm(formula = tiempo_recuperacion ~ edad + tratamiento + complicaciones, \n    family = Gamma(link = \"log\"), data = datos_operados)\n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    4.248493   0.132173  32.143  &lt; 2e-16 ***\nedad           0.007516   0.002077   3.619  0.00034 ***\ntratamientoB   0.228853   0.051474   4.446 1.18e-05 ***\ntratamientoC   0.416758   0.048329   8.623 2.40e-16 ***\ncomplicaciones 0.516802   0.050872  10.159  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Gamma family taken to be 0.1445412)\n\n    Null deviance: 75.286  on 349  degrees of freedom\nResidual deviance: 47.806  on 345  degrees of freedom\nAIC: 3784.7\n\nNumber of Fisher Scoring iterations: 5\n\n# Coeficientes exponentiados (√∫til para logit y log)\nlibrary(broom)\ntidy(modelo_logistico, exponentiate = TRUE, conf.int = TRUE)\n\n# A tibble: 4 √ó 7\n  term        estimate std.error statistic    p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)  0.00329    1.39       -4.12 0.0000386  0.000201    0.0475\n2 edad         1.05       0.0150      3.39 0.000705   1.02        1.08  \n3 imc          1.19       0.0378      4.54 0.00000572 1.10        1.28  \n4 fumador      3.13       0.390       2.93 0.00344    1.53        7.15  \n\n# Predicciones\npredict(modelo_recuperacion, type = \"response\")\n\n        1         2         3         4         5         6         7         8 \n126.23277 112.39500 150.05507 140.23978 171.79357 143.43824 159.35440 133.05222 \n        9        10        11        12        13        14        15        16 \n159.35440 216.47564 160.55667 101.93218 156.97681 281.61652 179.71843 165.45713 \n       17        18        19        20        21        22        23        24 \n160.55667 102.70122 130.08561 131.61246 167.96317 133.05222 271.22936 240.49665 \n       25        26        27        28        29        30        31        32 \n158.16114  98.91318 114.95818 154.63469 166.70544 155.80135 150.05507 269.19837 \n       33        34        35        36        37        38        39        40 \n158.16114 133.05222 247.83651 152.32751  93.14078  99.65944 107.43884 133.05222 \n       41        42        43        44        45        46        47        48 \n122.08271 101.16890 155.80135 162.98848 128.14471 154.63469 153.47677  99.65944 \n       49        50        51        52        53        54        55        56 \n133.05222 133.05222  95.98360 159.35440 101.16890 259.26924 108.24942 242.31110 \n       57        58        59        60        61        62        63        64 \n123.93179 103.47606 188.00887 126.23277 194.19955 201.16707 231.62616 219.75442 \n       65        66        67        68        69        70        71        72 \n166.70544 125.80888 169.62548 185.20374 121.16854 188.44780 166.70544 105.83583 \n       73        74        75        76        77        78        79        80 \n161.76801 144.52043 195.20896 108.24942 150.05476 174.80274 170.50716 107.43884 \n       81        82        83        84        85        86        87        88 \n228.17026 228.17026 124.34936 275.33744 147.81622 115.82549 114.09736 134.05604 \n       89        90        91        92        93        94        95        96 \n275.33744 126.23277 109.06612 112.39500 156.97713 148.93144 160.55667 171.79357 \n       97        98        99       100       101       102       103       104 \n101.16890 117.57980 301.32606 195.20896 171.79357 177.45033 139.18993 133.05222 \n      105       106       107       108       109       110       111       112 \n218.10887 111.55338 102.70122 187.03668 238.69578 109.06612 275.33744 267.18258 \n      113       114       115       116       117       118       119       120 \n101.16890 177.03701 166.70544 116.69935 126.23277 169.23039 175.71133 138.14766 \n      121       122       123       124       125       126       127       128 \n108.24942 156.97681 161.76834 116.69935 190.85648 167.96317 221.41238 206.92994 \n      129       130       131       132       133       134       135       136 \n159.35440 140.24007 118.46689 141.29812 126.23277 175.71133 121.57680 106.63432 \n      137       138       139       140       141       142       143       144 \n107.43884 144.52014 147.81622 105.04332 135.06744 310.52304 114.95818 277.41476 \n      145       146       147       148       149       150       151       152 \n114.09736 113.24298 156.97713 112.39500 114.09736 188.44780 106.63432 110.71805 \n      153       154       155       156       157       158       159       160 \n155.80166 172.19465 167.96317 122.08271 164.21817 153.47677 155.80135 161.76801 \n      161       162       163       164       165       166       167       168 \n173.49379 135.06744 134.05604 164.21817 171.79357 292.40147 124.86680 137.11319 \n      169       170       171       172       173       174       175       176 \n162.98848 186.60104 124.86680 138.14766 135.06744  95.98360 185.20374 130.08561 \n      177       178       179       180       181       182       183       184 \n153.47677 208.87108 140.24007 166.70544 112.77370 165.45713 148.93144 142.36416 \n      185       186       187       188       189       190       191       192 \n299.06970 127.71440 151.18718 160.55667 244.13925 164.21817 160.55667 111.09110 \n      193       194       195       196       197       198       199       200 \n103.47606 290.21194 162.98882 143.43824 144.52043 128.14471 169.23039 197.80516 \n      201       202       203       204       205       206       207       208 \n114.09736 145.61078 169.23039 115.82549 112.39500 116.69935 125.80888 150.05507 \n      209       210       211       212       213       214       215       216 \n109.88898 101.16890 171.79357 134.05604 312.86582 147.81592 134.05604 171.79357 \n      217       218       219       220       221       222       223       224 \n164.21817 132.05590 107.43884 242.31110 178.37268 244.13925 130.62693 201.63673 \n      225       226       227       228       229       230       231       232 \n112.39500 131.06705 207.30703 175.71133 104.25674 283.74121 162.98848 226.46169 \n      233       234       235       236       237       238       239       240 \n129.11151 167.96317 285.88193 101.16890 108.61415 162.98848 166.70544 144.52043 \n      241       242       243       244       245       246       247       248 \n233.37369 171.79357 153.47677 145.61078 145.61078 112.39500 310.52304 171.79357 \n      249       250       251       252       253       254       255       256 \n112.39500 141.29812 189.86957 303.59945 173.08969 194.19955 127.18515 134.05604 \n      257       258       259       260       261       262       263       264 \n123.00377 152.32751 112.39500 171.79357 148.93144 107.43884 169.23039 160.93151 \n      265       266       267       268       269       270       271       272 \n141.29812 104.25674 164.21817 126.23277 189.86957 145.61078 180.13801 125.80888 \n      273       274       275       276       277       278       279       280 \n115.82549 178.37268 127.71440 131.06705 177.03701 118.46689 166.70544 188.44780 \n      281       282       283       284       285       286       287       288 \n101.93218 143.43824 104.25674 177.03701 130.08561 285.88193 173.49379 108.24942 \n      289       290       291       292       293       294       295       296 \n147.81592 167.96317 179.71843 187.03668 202.31612 105.04332 124.86680 125.80888 \n      297       298       299       300       301       302       303       304 \n152.32751 134.05604 142.36416 170.50716 159.35440 154.63469 108.24942 148.93144 \n      305       306       307       308       309       310       311       312 \n138.14766 132.05590 105.83583 123.93179 224.76592 296.83023 206.23506 189.86957 \n      313       314       315       316       317       318       319       320 \n178.78912 166.70544 105.83583 120.26121 165.45713 123.00377 105.04332 159.35440 \n      321       322       323       324       325       326       327       328 \n233.37369 279.50774 105.83583  97.43738 109.88898 131.06705 181.07434 154.63469 \n      329       330       331       332       333       334       335       336 \n119.36068 267.18258 112.39500 117.57980 177.45033 174.39558 137.11319 153.47677 \n      337       338       339       340       341       342       343       344 \n135.06744 261.22586 164.21817 103.47606 229.89172 112.39500 179.71843 181.07434 \n      345       346       347       348       349       350 \n110.71805 120.26121 218.10887 154.99571 133.05222 160.55667",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Modelos lineales generalizados (GLM)</span>"
    ]
  },
  {
    "objectID": "Modelos_lineales.html#cap√≠tulo-3-regresi√≥n-log√≠stica-en-medicina",
    "href": "Modelos_lineales.html#cap√≠tulo-3-regresi√≥n-log√≠stica-en-medicina",
    "title": "6¬† Modelos lineales generalizados (GLM)",
    "section": "6.3 üìò Cap√≠tulo 3: Regresi√≥n log√≠stica en medicina",
    "text": "6.3 üìò Cap√≠tulo 3: Regresi√≥n log√≠stica en medicina\n\nObjetivos del cap√≠tulo:\n\nEntender qu√© es la regresi√≥n log√≠stica y cu√°ndo usarla\nAprender a construir un modelo log√≠stico en R\nInterpretar los coeficientes como odds ratios\nEvaluar el ajuste del modelo (AUC, curva ROC, matriz de confusi√≥n)\nVisualizar efectos de las variables predictoras\n\n\n\n¬øQu√© es la regresi√≥n log√≠stica?\nLa regresi√≥n log√≠stica es un tipo de Modelo Lineal Generalizado (GLM) utilizado cuando la variable dependiente es binaria, es decir, tiene dos posibles resultados:\n\n√âxito / Fracaso\nPresencia / Ausencia\nS√≠ / No\nEnfermo / Sano\n\nEn lugar de predecir directamente el valor de la variable respuesta, la regresi√≥n log√≠stica predice la probabilidad de que ocurra un evento.\nLa relaci√≥n entre las variables independientes y la probabilidad se modela mediante la funci√≥n logit:\n\\[\n\\log\\left(\\frac{p}{1 - p}\\right) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_p x_p\n\\]\nDonde \\(p\\) es la probabilidad de que ocurra el evento.\n\n\nEjemplo m√©dico: Predicci√≥n de riesgo de diabetes\nUsaremos el dataset simulado datos_medicos, que contiene informaci√≥n de 500 pacientes y una variable binaria diabetes que indica si tienen o no diabetes.\n\n\nConstrucci√≥n del modelo log√≠stico\nVamos a construir un modelo para predecir la probabilidad de tener diabetes en funci√≥n de la edad, IMC, si fuma y si hay antecedentes familiares.\n\nmodelo_logistico &lt;- glm(diabetes ~ edad + imc + fumador + familia_diab,\n                        data = datos_medicos, family = binomial(link = \"logit\"))\n\nsummary(modelo_logistico)\n\n\nCall:\nglm(formula = diabetes ~ edad + imc + fumador + familia_diab, \n    family = binomial(link = \"logit\"), data = datos_medicos)\n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  -6.40003    1.46226  -4.377  1.2e-05 ***\nedad          0.05460    0.01549   3.525 0.000424 ***\nimc           0.18036    0.03897   4.628  3.7e-06 ***\nfumador       1.32734    0.39826   3.333 0.000860 ***\nfamilia_diab  1.38516    0.46612   2.972 0.002962 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 382.57  on 499  degrees of freedom\nResidual deviance: 331.47  on 495  degrees of freedom\nAIC: 341.47\n\nNumber of Fisher Scoring iterations: 6\n\n\n\n\nSalida (resumen):\nEste c√≥digo nos dar√° una salida similar a:\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    -5.9321     0.7541  -7.866 3.67e-15 ***\nedad            0.0493     0.0121   4.074 4.63e-05 ***\nimc             0.1011     0.0247   4.093 4.26e-05 ***\nfumador         0.7812     0.2338   3.341 0.000835 ***\nfamilia_diab    1.1823     0.2714   4.357 1.32e-05 ***\n\n\nInterpretaci√≥n de los coeficientes\nLos coeficientes est√°n en escala log-odds, pero al exponentiarlos obtenemos los odds ratios, que son m√°s interpretables cl√≠nicamente.\n\nlibrary(broom)\ntidy_modelo &lt;- tidy(modelo_logistico, exponentiate = TRUE, conf.int = TRUE)\ntidy_modelo\n\n# A tibble: 5 √ó 7\n  term         estimate std.error statistic    p.value  conf.low conf.high\n  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)   0.00166    1.46       -4.38 0.0000120  0.0000872    0.0274\n2 edad          1.06       0.0155      3.52 0.000424   1.03         1.09  \n3 imc           1.20       0.0390      4.63 0.00000370 1.11         1.30  \n4 fumador       3.77       0.398       3.33 0.000860   1.81         8.75  \n5 familia_diab  4.00       0.466       2.97 0.00296    1.72        11.0   \n\n\nEjemplo de interpretaci√≥n:\n\nUn punto adicional de IMC aumenta la odds de tener diabetes en un factor de aproximadamente 1.10 (un 10% m√°s de odds).\nTener antecedentes familiares de diabetes multiplica por 3.26 las probabilidades de tener diabetes.\n\n\n\nEvaluaci√≥n del modelo\n\n\n1. Predicciones de probabilidad\n\npredicciones &lt;- predict(modelo_logistico, type = \"response\")\nhead(predicciones)\n\n        1         2         3         4         5         6 \n0.7094187 0.8956432 0.9632471 0.9727757 0.6514602 0.9247754 \n\n\n\n\n2. Curva ROC y AUC\n\nlibrary(pROC)\n\nType 'citation(\"pROC\")' for a citation.\n\n\n\nAdjuntando el paquete: 'pROC'\n\n\nThe following objects are masked from 'package:stats':\n\n    cov, smooth, var\n\nroc_obj &lt;- roc(datos_medicos$diabetes, predicciones)\n\nSetting levels: control = 0, case = 1\n\n\nSetting direction: controls &lt; cases\n\nplot(roc_obj, main = \"Curva ROC del modelo log√≠stico\")\n\n\n\n\n\n\n\nauc(roc_obj)\n\nArea under the curve: 0.754\n\n\nUn AUC cercano a 1 indica buen rendimiento discriminativo.\n\n\n3. Matriz de confusi√≥n\n\npredicciones_clase &lt;- ifelse(predicciones &gt; 0.5, 1, 0)\ntable(real = datos_medicos$diabetes, predicho = predicciones_clase)\n\n    predicho\nreal   0   1\n   0   5  59\n   1   0 436\n\n\n\n\n4. M√©tricas b√°sicas\n\nlibrary(caret)\n\nCargando paquete requerido: ggplot2\n\n\nCargando paquete requerido: lattice\n\nconfusionMatrix(factor(predicciones_clase), factor(datos_medicos$diabetes))\n\nConfusion Matrix and Statistics\n\n          Reference\nPrediction   0   1\n         0   5   0\n         1  59 436\n                                          \n               Accuracy : 0.882           \n                 95% CI : (0.8504, 0.9089)\n    No Information Rate : 0.872           \n    P-Value [Acc &gt; NIR] : 0.277           \n                                          \n                  Kappa : 0.1288          \n                                          \n Mcnemar's Test P-Value : 4.321e-14       \n                                          \n            Sensitivity : 0.07812         \n            Specificity : 1.00000         \n         Pos Pred Value : 1.00000         \n         Neg Pred Value : 0.88081         \n             Prevalence : 0.12800         \n         Detection Rate : 0.01000         \n   Detection Prevalence : 0.01000         \n      Balanced Accuracy : 0.53906         \n                                          \n       'Positive' Class : 0               \n                                          \n\n\n\n\nVisualizaci√≥n de efectos\n\n\nUsando visreg:\n\nlibrary(visreg)\nvisreg(modelo_logistico, \"imc\", scale = \"response\",\n       xlab = \"√çndice de masa corporal\", ylab = \"Probabilidad de diabetes\")\n\n\n\n\n\n\n\n\n\n\nEfecto de antecedentes familiares:\n\nvisreg(modelo_logistico, \"familia_diab\", scale = \"response\",\n       xlab = \"Antecedentes familiares\", ylab = \"Probabilidad de diabetes\")\n\n\n\n\n\n\n\n\n\n\nConclusi√≥n\nLa regresi√≥n log√≠stica es una herramienta fundamental en investigaci√≥n m√©dica para modelar variables binarias. Permite:\n\nPredecir riesgos (ej. desarrollo de enfermedades)\nCalcular odds ratios f√°cilmente\nValidar modelos con m√©tricas cl√≠nicas relevantes (AUC, sensibilidad, especificidad)\nVisualizar efectos de forma intuitiva",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Modelos lineales generalizados (GLM)</span>"
    ]
  },
  {
    "objectID": "Modelos_lineales.html#cap√≠tulo-4-regresi√≥n-de-poisson-y-binomial-negativa-en-medicina",
    "href": "Modelos_lineales.html#cap√≠tulo-4-regresi√≥n-de-poisson-y-binomial-negativa-en-medicina",
    "title": "6¬† Modelos lineales generalizados (GLM)",
    "section": "6.4 üìò Cap√≠tulo 4: Regresi√≥n de Poisson y binomial negativa en medicina",
    "text": "6.4 üìò Cap√≠tulo 4: Regresi√≥n de Poisson y binomial negativa en medicina\n\nObjetivos del cap√≠tulo:\n\nEntender qu√© es un modelo de conteo y cu√°ndo usarlo\nAprender a construir modelos de Poisson y binomial negativa en R\nDetectar y manejar la sobredispersi√≥n\nInterpretar los coeficientes como tasas relativas\nValidar y visualizar resultados cl√≠nicos relevantes\n\n\n\n6.4.1 ¬øQu√© es la regresi√≥n de Poisson?\nLa regresi√≥n de Poisson es un tipo de Modelo Lineal Generalizado (GLM) usado cuando la variable dependiente representa conteos, es decir, valores enteros no negativos:\n\nN√∫mero de hospitalizaciones en un a√±o\nN√∫mero de reca√≠das\nN√∫mero de eventos adversos\nN√∫mero de infecciones\n\nEste modelo asume que la media y la varianza son iguales, lo cual no siempre ocurre en la pr√°ctica m√©dica.\n\n\nEjemplo m√©dico: N√∫mero de hospitalizaciones\nUsaremos el dataset simulado datos_hosp, que contiene informaci√≥n de 300 pacientes y una variable hospitalizaciones que indica cu√°ntas veces han sido hospitalizados en el √∫ltimo a√±o.\n\n\nConstrucci√≥n del modelo de Poisson\nVamos a construir un modelo para predecir el n√∫mero de hospitalizaciones en funci√≥n de la edad, enfermedad, IMC, si fuma y el tiempo desde el diagn√≥stico.\n\nmodelo_poisson &lt;- glm(hospitalizaciones ~ edad + enfermedad + bmi + fumador + tiempo_enfermedad,\n                      data = datos_hosp, family = poisson())\n\nsummary(modelo_poisson)\n\n\nCall:\nglm(formula = hospitalizaciones ~ edad + enfermedad + bmi + fumador + \n    tiempo_enfermedad, family = poisson(), data = datos_hosp)\n\nCoefficients:\n                   Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       -1.575426   0.267668  -5.886 3.96e-09 ***\nedad               0.029293   0.002833  10.341  &lt; 2e-16 ***\nenfermedadEPOC     0.308507   0.060312   5.115 3.13e-07 ***\nenfermedadHTA     -0.401106   0.074307  -5.398 6.74e-08 ***\nbmi                0.016149   0.006558   2.463   0.0138 *  \nfumador            0.571971   0.053827  10.626  &lt; 2e-16 ***\ntiempo_enfermedad  0.061805   0.006604   9.359  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 696.17  on 299  degrees of freedom\nResidual deviance: 242.76  on 293  degrees of freedom\nAIC: 1205.5\n\nNumber of Fisher Scoring iterations: 5\n\n\n\n\nSalida (resumen):\nEjemplo de salida:\nCoefficients:\n                  Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       -1.98      0.15    -13.2   &lt;2e-16 ***\nedad               0.03      0.003     9.9   &lt;2e-16 ***\nenfermedadDiabetes 0.41      0.08      5.1   3e-07 ***\nenfermedadEPOC     0.69      0.07     10.1   &lt;2e-16 ***\nbmi                0.02      0.005     4.2   2e-05 ***\nfumador            0.52      0.07      7.4   1e-13 ***\ntiempo_enfermedad  0.05      0.009     5.7   1e-08 ***\n\n\nInterpretaci√≥n de los coeficientes\nLos coeficientes est√°n en escala logar√≠tmica, por lo que al exponentiarlos obtenemos las tasas relativas.\n\nlibrary(broom)\ntidy_modelo &lt;- tidy(modelo_poisson, exponentiate = TRUE, conf.int = TRUE)\ntidy_modelo\n\n# A tibble: 7 √ó 7\n  term              estimate std.error statistic  p.value conf.low conf.high\n  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)          0.207   0.268       -5.89 3.96e- 9    0.122     0.350\n2 edad                 1.03    0.00283     10.3  4.57e-25    1.02      1.04 \n3 enfermedadEPOC       1.36    0.0603       5.12 3.13e- 7    1.21      1.53 \n4 enfermedadHTA        0.670   0.0743      -5.40 6.74e- 8    0.578     0.774\n5 bmi                  1.02    0.00656      2.46 1.38e- 2    1.00      1.03 \n6 fumador              1.77    0.0538      10.6  2.25e-26    1.59      1.97 \n7 tiempo_enfermedad    1.06    0.00660      9.36 8.03e-21    1.05      1.08 \n\n\n\n\nEjemplo de interpretaci√≥n:\n\nUn punto adicional de IMC multiplica la tasa de hospitalizaci√≥n por 1.02.\nSer fumador multiplica la tasa de hospitalizaci√≥n por 1.68.\nTener EPOC multiplica la tasa por 2.00 respecto a tener HTA.\n\n\n\nDiagn√≥stico: ¬øHay sobredispersi√≥n?\nUn supuesto importante de la regresi√≥n de Poisson es que la varianza sea igual a la media. En muchos casos m√©dicos esto no se cumple ‚Üí sobredispersi√≥n.\n\n\nComprobaci√≥n r√°pida:\n\nif (var(datos_hosp$hospitalizaciones) &gt; mean(datos_hosp$hospitalizaciones)) {\n  print(\"Advertencia: Sobredispersi√≥n detectada.\")\n}\n\n[1] \"Advertencia: Sobredispersi√≥n detectada.\"\n\n\nTambi√©n puedes calcular el cociente:\n\nphi &lt;- sum(residuals(modelo_poisson, type = \"pearson\")^2) / df.residual(modelo_poisson)\nprint(paste(\"√çndice de dispersi√≥n:\", phi))\n\n[1] \"√çndice de dispersi√≥n: 0.800588043062644\"\n\n\nSi phi &gt; 1.5, hay sobredispersi√≥n significativa.\n\n\nAlternativa: Regresi√≥n binomial negativa\nCuando hay sobredispersi√≥n, se puede usar la regresi√≥n binomial negativa, que permite que la varianza sea mayor que la media.\n\nlibrary(MASS)\nmodelo_negbin &lt;- glm.nb(hospitalizaciones ~ edad + enfermedad + bmi + fumador + tiempo_enfermedad,\n                        data = datos_hosp)\n\nWarning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =\ncontrol$trace &gt; : iteration limit reached\nWarning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =\ncontrol$trace &gt; : iteration limit reached\n\nsummary(modelo_negbin)\n\n\nCall:\nglm.nb(formula = hospitalizaciones ~ edad + enfermedad + bmi + \n    fumador + tiempo_enfermedad, data = datos_hosp, init.theta = 70465.45106, \n    link = log)\n\nCoefficients:\n                   Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       -1.575448   0.267683  -5.885 3.97e-09 ***\nedad               0.029293   0.002833  10.341  &lt; 2e-16 ***\nenfermedadEPOC     0.308508   0.060315   5.115 3.14e-07 ***\nenfermedadHTA     -0.401107   0.074310  -5.398 6.75e-08 ***\nbmi                0.016150   0.006558   2.463   0.0138 *  \nfumador            0.571978   0.053830  10.626  &lt; 2e-16 ***\ntiempo_enfermedad  0.061805   0.006604   9.359  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(70465.45) family taken to be 1)\n\n    Null deviance: 696.12  on 299  degrees of freedom\nResidual deviance: 242.74  on 293  degrees of freedom\nAIC: 1207.5\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  70465 \n          Std. Err.:  528410 \nWarning while fitting theta: iteration limit reached \n\n 2 x log-likelihood:  -1191.457 \n\n\nEste modelo tambi√©n interpreta los coeficientes como tasas relativas.\n\n\nEvaluaci√≥n del modelo\n\n\n1. Predicciones de conteo esperado\n\npredicciones &lt;- predict(modelo_negbin, type = \"response\")\nhead(predicciones)\n\n       1        2        3        4        5        6 \n2.304840 4.317644 4.950760 3.077807 2.766315 5.477275 \n\n\n\n\n2. Gr√°fico de residuos\n\nplot(fitted(modelo_negbin), residuals(modelo_negbin, type = \"pearson\"))\n\n\n\n\n\n\n\n\n\n\n3. Comparaci√≥n de modelos (AIC)\n\nAIC(modelo_poisson, modelo_negbin)\n\n               df      AIC\nmodelo_poisson  7 1205.452\nmodelo_negbin   8 1207.457\n\n\nEl modelo con menor AIC tiene mejor ajuste.\n\n\nVisualizaci√≥n de efectos\n\n\nUsando visreg:\n\nlibrary(visreg)\nvisreg(modelo_negbin, \"bmi\", scale = \"response\",\n       xlab = \"√çndice de masa corporal\", ylab = \"N√∫mero esperado de hospitalizaciones\")\n\nWarning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =\ncontrol$trace &gt; : iteration limit reached\nWarning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =\ncontrol$trace &gt; : iteration limit reached\n\n\n\n\n\n\n\n\n\n\n\nEfecto de ser fumador:\n\nvisreg(modelo_negbin, \"fumador\", scale = \"response\",\n       xlab = \"Fumador\", ylab = \"N√∫mero esperado de hospitalizaciones\")\n\nWarning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =\ncontrol$trace &gt; : iteration limit reached\nWarning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =\ncontrol$trace &gt; : iteration limit reached\n\n\n\n\n\n\n\n\n\n\n\nConclusi√≥n\nLa regresi√≥n de Poisson y la binomial negativa son herramientas clave para modelar variables de conteo en investigaci√≥n m√©dica. Permite:\n\nModelar eventos repetidos (ej. hospitalizaciones, reca√≠das)\nManejar sobredispersi√≥n con la binomial negativa\nInterpretar resultados como tasas relativas\nVisualizar efectos de forma intuitiva",
    "crumbs": [
      "Contenidos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Modelos lineales generalizados (GLM)</span>"
    ]
  }
]